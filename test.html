<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="https://image.makewebeasy.net/makeweb/0/pMrtkmxgt/APNG_images/bot_02.png?v=202012190947" rel="shortcut icon" />

    <!-- Sweet Alert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous" />

    <title>Share Flex Message จ้ะ</title>
  </head>
  <body>
    <p></p>
    <p></p>
    <p></p>
    <center> . . . . . กำลังโหลด . . . . .</center>
    <center>
      <img src="https://image.makewebeasy.net/makeweb/0/pMrtkmxgt/APNG_images/loader1_1.gif?v=202012190947" alt="loading" width="126" height="129" />
      <br>กรุณารอสักครู่
    </center>
    <p> wait...</p>

    <script>
      window.onload = function (e) {
        if (typeof liff === "undefined") {
          console.error("LIFF SDK is not loaded.");
          return;
        }

        liff.init(
          {
            liffId: "2006828731-6WBlj9gQ",
          },
          function () {
            console.log("LIFF Init Success");
            if (liff.isLoggedIn()) {
              dolink();
            } else {
              console.log("User not logged in, redirecting to login...");
              liff.login();
            }
          },
          function (error) {
            console.error("LIFF Initialization Failed:", error);
          }
        );

        function getParameterByName(name, url) {
          if (!url) url = window.location.href;
          name = name.replace(/[\[\]]/g, "\\$&");
          var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
          if (!results) return null;
          if (!results[2]) return "";
          return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        function dolink() {
          var j5 = getParameterByName("refer");
          console.log("Received refer:", j5);

          if (!j5) {
            console.error("Refer parameter is missing.");
            return;
          }

          if (j5 === "ex0") {
            console.log("Sending message...");
            liff
              .sendMessages([
                {
                  type: "text",
                  text: "Hello สวัสดีจร้า",
                },
              ])
              .then(function () {
                console.log("Message sent successfully");
                liff.closeWindow();
              })
              .catch(function (error) {
                console.error("Error sending message:", error);
              });
          }

          if (j5 === "sharepr1") {
            console.log("Sharing Flex Message...");
            liff
              .shareTargetPicker([
                {
                  type: "carousel",
                  contents: [
                    {
                      type: "bubble",
                      size: "mega",
                      header: {
                        type: "box",
                        layout: "vertical",
                        contents: [
                          {
                            type: "image",
                            url: "https://j5pr.rtarf.mi.th/FlexMsg/PRD/images/2rdo/bg222.jpg",
                            size: "full",
                            margin: "none",
                            aspectRatio: "2:3",
                            aspectMode: "cover",
                            offsetTop: "sm",
                            offsetStart: "none",
                            offsetEnd: "none",
                          },
                          {
                            type: "text",
                            text: "วันที่ 31 มกราคม พ.ศ.2568",
                            weight: "bold",
                            align: "center",
                            color: "#f9fbfc",
                            size: "lg",
                            offsetTop: "sm",
                          },
                        ],
                        backgroundColor: "#010150",
                        spacing: "none",
                        margin: "none",
                        borderWidth: "none",
                        cornerRadius: "none",
                        paddingAll: "md",
                        offsetStart: "none",
                      },
                      body: {
                        type: "box",
                        layout: "horizontal",
                        contents: [
                          {
                            type: "box",
                            layout: "horizontal",
                            contents: [
                              {
                                type: "image",
                                url: "https://img2.pic.in.th/pic/a229d55e7804dfacea.jpg",
                                aspectMode: "cover",
                                align: "start",
                                size: "full",
                                action: {
                                  type: "uri",
                                  label: "action",
                                  uri: "https://2rdo.rtarf.mi.th/",
                                },
                              },
                              {
                                type: "image",
                                url: "https://img5.pic.in.th/file/secure-sv1/a3b805f1ee6205ac91.jpg",
                                size: "full",
                                aspectMode: "cover",
                                action: {
                                  type: "uri",
                                  label: "action",
                                  uri: "https://www.facebook.com/?locale=th_TH",
                                },
                              },
                              {
                                type: "image",
                                url: "https://img5.pic.in.th/file/secure-sv1/a4.jpg",
                                size: "full",
                                aspectMode: "cover",
                                action: {
                                  type: "uri",
                                  label: "action",
                                  uri: "https://www.instagram.com/explore/locations/274653324/",
                                },
                              },
                              {
                                type: "image",
                                url: "https://img2.pic.in.th/pic/a5518c64bf45751ccd.jpg",
                                size: "full",
                                aspectMode: "cover",
                                action: {
                                  type: "uri",
                                  label: "action",
                                  uri: "https://www.tiktok.com/@2nd_regional_development?_t=8rgJsYKALvs&_r=1",
                                },
                              },
                            ],
                            backgroundColor: "#010150",
                          },
                        ],
                        paddingAll: "lg",
                        backgroundColor: "#010150",
                        offsetTop: "none",
                      },
                      footer: {
                        type: "box",
                        layout: "vertical",
                        contents: [
                          {
                            type: "image",
                            url: "https://img2.pic.in.th/pic/a699afa1d7b843a63a.jpg",
                            size: "xl",
                            aspectMode: "cover",
                            aspectRatio: "6:1.5",
                            action: {
                              type: "uri",
                              label: "action",
                              uri: "https://liff.line.me/2006802212-Z0oL2zEy?refer=act31012568",
                            },
                          },
                        ],
                        spacing: "xxl",
                        margin: "xxl",
                        paddingAll: "md",
                        backgroundColor: "#127cc0",
                      },
                    },
                    // Add more bubbles here if needed
                  ],
                },
              ])
              .then(function () {
                console.log("Flex message sent successfully");
                if (typeof Swal !== "undefined") {
                  Swal.fire({
                    position: "top-center",
                    icon: "success",
                    title: "ส่ง เรียบร้อย",
                    showConfirmButton: false,
                    timer: 1500,
                  }).then(() => {
                    liff.closeWindow();
                  });
                } else {
                  console.error("SweetAlert2 is not loaded.");
                }
              })
              .catch(function (error) {
                console.error("Error sharing Flex Message:", error);
              });
          }
        }
      };
    </script>

    <!-- LIFF SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <!-- Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
